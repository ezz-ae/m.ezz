{
  "entities": {
    "User": {
      "title": "User",
      "description": "Represents a user of the system (e.g., Mahmoud).",
      "type": "object",
      "properties": {
        "displayName": { "type": "string", "description": "User's display name." },
        "email": { "type": "string", "description": "User's email address.", "format": "email" },
        "createdAt": { "type": "string", "description": "Timestamp indicating when the user was created.", "format": "date-time" },
        "role": { "type": "string", "description": "User's role in the system.", "enum": ["owner", "guest", "beta"] }
      },
      "required": ["displayName", "email", "createdAt", "role"]
    },
    "Notebook": {
      "title": "Notebook",
      "description": "Represents one 'living intelligence document' or sovereign intelligence.",
      "type": "object",
      "properties": {
        "ownerId": { "type": "string", "description": "ID of the user who owns the notebook." },
        "slug": { "type": "string", "description": "URL-friendly slug for the notebook." },
        "title": { "type": "string", "description": "Title of the notebook." },
        "description": { "type": "string", "description": "Purpose of the notebook." },
        "visibility": { "type": "string", "description": "Visibility of the notebook.", "enum": ["public", "private", "unlisted"] },
        "status": { "type": "string", "description": "Operational status of the notebook.", "enum": ["active", "sleeping", "archived"] },
        "tags": { "type": "array", "items": { "type": "string" }, "description": "Tags associated with the notebook." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp of creation." },
        "updatedAt": { "type": "string", "format": "date-time", "description": "Timestamp of last update." },
        "fctProfile": {
          "type": "object",
          "properties": {
            "fadeMode": { "type": "string", "enum": ["soft", "strict"] },
            "maxBufferSize": { "type": "number" }
          },
          "required": ["fadeMode", "maxBufferSize"]
        },
        "config": {
          "type": "object",
          "properties": {
            "languages": { "type": "array", "items": { "type": "string" } },
            "masterSkills": { "type": "array", "items": { "type": "string" } },
            "learningDomains": { "type": "array", "items": { "type": "object", "properties": { "domain": { "type": "string" }, "depth": { "type": "string", "enum": ["Beginner", "Practitioner", "Expert"] } } } },
            "inputs": { "type": "array", "items": { "type": "string" } },
            "outputs": { "type": "array", "items": { "type": "string" } }
          }
        }
      },
      "required": ["ownerId", "slug", "title", "status", "visibility", "createdAt", "updatedAt", "fctProfile"]
    },
    "Note": {
      "title": "Note",
      "description": "Represents an atomic piece of input (text, thought, extract, transcript).",
      "type": "object",
      "properties": {
        "authorId": { "type": "string", "description": "ID of the user who authored the note." },
        "content": { "type": "string", "description": "Content of the note." },
        "source": { "type": "string", "description": "Source of the note.", "enum": ["manual", "import", "transcript", "ai"] },
        "sessionId": { "type": "string", "description": "ID of the session this note belongs to." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp of creation." },
        "updatedAt": { "type": "string", "format": "date-time", "description": "Timestamp of last update." }
      },
      "required": ["authorId", "content", "source", "createdAt", "updatedAt"]
    },
    "VertexEntry": {
      "title": "Vertex Entry",
      "description": "Represents the metadata stored alongside a vector embedding in the Notebook Vertex (Vector DB).",
      "type": "object",
      "properties": {
        "owner_did": { "type": "string", "description": "Decentralized Identifier of the owner." },
        "notebook_id": { "type": "string", "description": "ID of the notebook this entry belongs to." },
        "source_note_id": { "type": "string", "description": "The original note from which the vector was derived." },
        "tag_type": { "type": "string", "description": "The semantic type of the content (e.g., 'question', 'decision', 'raw_log')." },
        "reflection_status": { "type": "string", "description": "The current state in the FCT lifecycle.", "enum": ["raw", "processed", "fading", "archived"] },
        "schema_id": { "type": "string", "description": "Identifier for the extracted pattern or schema this vector contributes to." },
        "emotional_tag": { "type": "string", "description": "FCT-based emotional or intentional tag." },
        "timestamp": { "type": "string", "format": "date-time" }
      },
      "required": ["owner_did", "notebook_id", "source_note_id", "tag_type", "reflection_status", "timestamp"]
    }
  },
  "auth": {
    "providers": ["password", "anonymous"]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": { "schema": { "$ref": "#/backend/entities/User" }, "description": "Stores user profiles." }
      },
      {
        "path": "/notebooks/{notebookId}",
        "definition": { "schema": { "$ref": "#/backend/entities/Notebook" }, "description": "Stores sovereign intelligence notebooks." }
      },
      {
        "path": "/notebooks/{notebookId}/notes/{noteId}",
        "definition": { "schema": { "$ref": "#/backend/entities/Note" }, "description": "Stores notes within a specific notebook." }
      }
    ]
  },
  "api": {
    "sensehub": {
      "description": "The SenseHub ingestion engine for the NotefullBook Memory Fabric.",
      "endpoints": [
        {
          "path": "/mem/entry",
          "method": "POST",
          "description": "Adds a new signed entry (NotebookML Envelope) to the memory fabric. The entry is processed, vectorized, and stored in the Notebook Vertex.",
          "request": {
            "body": {
              "schema": {
                "type": "object",
                "properties": {
                  "notebookId": { "type": "string" },
                  "notebookml_content": { "type": "string" },
                  "signature": { "type": "string" }
                },
                "required": ["notebookId", "notebookml_content", "signature"]
              }
            }
          },
          "response": {
            "202": { "description": "Accepted for processing." }
          }
        }
      ]
    },
    "adept": {
      "description": "The ADEPT/Reflection engine for orchestrating and querying intelligence.",
      "endpoints": [
        {
          "path": "/mem/search",
          "method": "GET",
          "description": "Performs a Meaning-First Retrieval (MFR) query against the Notebook Vertex using FCT-based criteria.",
          "request": {
            "query_params": {
              "q": { "type": "string", "description": "The natural language query." },
              "notebook_id": { "type": "string", "description": "The ID of the notebook to search within." },
              "k": { "type": "number", "description": "The number of results to return." },
              "intent": { "type": "string", "description": "The user's intent to guide FCT-based recall." }
            }
          },
          "response": {
            "200": {
              "description": "A list of contextually relevant schemas, logic rules, and behavioral artifacts.",
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/backend/entities/VertexEntry"
                }
              }
            }
          }
        }
      ]
    }
  }
}